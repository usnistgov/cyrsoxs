<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CyRSoXS: /github/workspace/include/Rotation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CyRSoXS
   &#160;<span id="projectnumber">1.1.6.0</span>
   </div>
   <div id="projectbrief">GPU Accelerated RSoXS Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Rotation.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Rotation_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// MIT License</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//Copyright (c) 2019 - 2022 Iowa State University</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//Permission is hereby granted, free of charge, to any person obtaining a copy</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//of this software and associated documentation files (the &quot;Software&quot;), to deal</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//in the Software without restriction, including without limitation the rights</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//copies of the Software, and to permit persons to whom the Software is</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//furnished to do so, subject to the following conditions:</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//The above copyright notice and this permission notice shall be included in all</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//copies or substantial portions of the Software.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//SOFTWARE.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef CY_RSOXS_ROTATION_H</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define CY_RSOXS_ROTATION_H</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Datatypes_8h.html">Datatypes.h</a>&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cudaHeaders_8h.html">cudaHeaders.h</a>&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structMatrix.html">   33</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structMatrix.html">Matrix</a>{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">   36</a></span>&#160;  <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> <a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[9]{};</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structMatrix.html#a52c662f7ee48b0491cf1c3bb895f159d">   41</a></span>&#160;  __host__ __device__ <a class="code" href="structMatrix.html#a52c662f7ee48b0491cf1c3bb895f159d">Matrix</a>(){</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    std::memset(<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>) * 9);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structMatrix.html#a03c741bad8657073a58bf7dc7fdfa01d">   48</a></span>&#160;  __host__  <a class="code" href="structMatrix.html#a03c741bad8657073a58bf7dc7fdfa01d">Matrix</a>(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> * A){</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    std::memcpy(<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>, A, <span class="keyword">sizeof</span>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>) * 9);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">template</span>&lt;UINT <span class="keywordtype">id</span>1, UINT <span class="keywordtype">id</span>2&gt;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">   58</a></span>&#160;  __host__ __device__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>  <a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> matID = id1*3 +id2;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    static_assert((matID &lt; 9),<span class="stringliteral">&quot;Wrong matID&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[matID];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structMatrix.html#aa0f15befa8c221eb7ced641ece7a1b53">   68</a></span>&#160;  __host__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span>  <a class="code" href="structMatrix.html#aa0f15befa8c221eb7ced641ece7a1b53">getValue</a>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> * mat)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    std::memcpy(mat,<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>, <span class="keyword">sizeof</span>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>)*9);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">template</span>&lt;UINT <span class="keywordtype">id</span>1, UINT <span class="keywordtype">id</span>2&gt;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">   79</a></span>&#160;  __host__ __device__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span>  <a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; value) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> matID = id1*3 +id2;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    static_assert((matID &lt; 9),<span class="stringliteral">&quot;Wrong matID&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[matID] = value;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structMatrix.html#ac25f254ccf0e9c3dd291eb312a0ac5d7">   88</a></span>&#160;  __host__ __device__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span>  <a class="code" href="structMatrix.html#ac25f254ccf0e9c3dd291eb312a0ac5d7">setIdentity</a>(){</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    std::memset(<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>) * 9);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    this-&gt;setValue&lt;0,0&gt;(1);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    this-&gt;setValue&lt;1,1&gt;(1);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    this-&gt;setValue&lt;2,2&gt;(1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structMatrix.html#aae7ff8e192d45879b7e252a99aaf673e">   97</a></span>&#160;  __host__ __device__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span>  <a class="code" href="structMatrix.html#aae7ff8e192d45879b7e252a99aaf673e">reset</a>(){</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    std::memset(<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>) * 9);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">bool</span> transpose1, <span class="keywordtype">bool</span> transpose2&gt;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structMatrix.html#a385c6db6cce3eac9018d3e8e03f394b7">  109</a></span>&#160;  __host__ __device__ <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structMatrix.html#a385c6db6cce3eac9018d3e8e03f394b7">performMatrixMultiplication</a>(<span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp;B) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    this-&gt;<a class="code" href="structMatrix.html#aae7ff8e192d45879b7e252a99aaf673e">reset</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (not(transpose1) and not(transpose2)) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; ++k) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] += A.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + k] * B.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[k * 3 + j];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span>(not(transpose1) and transpose2){</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; ++k) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] += A.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + k] * B.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[j * 3 + k];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span>((transpose1) and not(transpose2)){</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; ++k) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] += A.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[k * 3 + i] * B.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[k * 3 + j];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span>((transpose1) and (transpose2)){</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; ++k) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] += A.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[k * 3 + i] * B.<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[j * 3 + k];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structMatrix.html#ac077e53d097d15478df9baa786fc0856">  150</a></span>&#160;  __host__ <span class="keywordtype">void</span> <a class="code" href="structMatrix.html#ac077e53d097d15478df9baa786fc0856">print</a>()<span class="keyword">const</span>{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        std::cout &lt;&lt; this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structMatrix.html#aa0d24add176004ed05a83dce58b983e1">  158</a></span>&#160;  __host__ <span class="keywordtype">void</span> <a class="code" href="structMatrix.html#aa0d24add176004ed05a83dce58b983e1">printToFile</a>(std::ofstream &amp; fout)<span class="keyword">const</span>{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        fout &lt;&lt; this-&gt;<a class="code" href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">matrix</a>[i * 3 + j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      fout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;};</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> computeDotProduct(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecA, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecB){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">return</span> (vecA.x*vecB.x + vecA.y*vecB.y + vecA.z*vecB.z);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> computeCrossProduct(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecA, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecB){</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> crossProduct;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  crossProduct.x =   vecA.y*vecB.z - vecA.z*vecB.y;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  crossProduct.y = -(vecA.x*vecB.z - vecA.z*vecB.x);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  crossProduct.z =   vecA.x*vecB.y - vecA.y*vecB.x;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span> crossProduct;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> computeVecNorm(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vec){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">return</span> (sqrt(computeDotProduct(vec,vec)));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> computeNormCrossproduct(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecA, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecB){</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; crossProduct = computeCrossProduct(vecA,vecB);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">return</span> (sqrt(computeDotProduct(crossProduct,crossProduct)));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> scaleVec(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vecIn, <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; scaledVec, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; scaleFactor){</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  scaledVec.x = scaleFactor*vecIn.x;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  scaledVec.y = scaleFactor*vecIn.y;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  scaledVec.z = scaleFactor*vecIn.z;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;__host__ <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> computeInverseMatrix(<span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp;  matrixA, <a class="code" href="structMatrix.html">Matrix</a> &amp; inverseMatrix){</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">double</span> det = matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,0&gt;() * (matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;()) -</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;               matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,1&gt;() * (matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;()) +</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;               matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,2&gt;() * (matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//  bool val = fabs(det) &lt; 1E-12;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//  assert(not(val));</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> invdet = 1. / det;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,0&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;()) * invdet) ;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,1&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,2&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;()) * invdet) ;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,2&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,1&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,2&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;()) * invdet) ;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,0&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;()) * invdet) ;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,1&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,2&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;()) * invdet) ;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,2&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,2&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,2&gt;()) * invdet) ;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,0&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;()) * invdet) ;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,1&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,1&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;2,1&gt;()) * invdet) ;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  inverseMatrix.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,2&gt;((matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,1&gt;() - matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;1,0&gt;() * matrixA.<a class="code" href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">getValue</a>&lt;0,1&gt;()) * invdet) ;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">bool</span> transpose1, <span class="keywordtype">bool</span> transpose2&gt;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;__host__ <span class="keyword">static</span> <span class="keywordtype">void</span> <span class="keyword">inline</span> performMatrixMultiplication(<span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp;  matA, <span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp;  matB, <a class="code" href="structMatrix.html">Matrix</a> &amp;  mat) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  mat.<a class="code" href="structMatrix.html#aae7ff8e192d45879b7e252a99aaf673e">reset</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  mat.<a class="code" href="structMatrix.html#a385c6db6cce3eac9018d3e8e03f394b7">performMatrixMultiplication</a>&lt;transpose1,transpose2&gt;(matA,matB);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;__host__ <span class="keyword">static</span> <span class="keywordtype">void</span> computeRotationMatrix(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; originalVec,<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; transformedVec ,<a class="code" href="structMatrix.html">Matrix</a> &amp; <a class="code" href="classRotationMatrix.html">RotationMatrix</a>){</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="classRotationMatrix.html">RotationMatrix</a>.reset();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(originalVec.x,transformedVec.x)) and (<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(originalVec.y,transformedVec.y)) and (<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(originalVec.z,transformedVec.z))){</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classRotationMatrix.html">RotationMatrix</a>.setIdentity();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> dotProduct = computeDotProduct(originalVec,transformedVec);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; crossVec = computeCrossProduct(originalVec,transformedVec);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> normCrossProduct = computeVecNorm(crossVec);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="structMatrix.html">Matrix</a> G;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,0&gt;(dotProduct);       G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,1&gt;(-normCrossProduct);  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,2&gt;(0);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,0&gt;(normCrossProduct); G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,1&gt;(dotProduct)       ;  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,2&gt;(0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,0&gt;(0);                G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,1&gt;(0)                ;  G.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,2&gt;(1);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> scaledVec;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  scaleVec(originalVec,scaledVec,dotProduct);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> subVec{transformedVec.x - scaledVec.x,transformedVec.y - scaledVec.y,transformedVec.z - scaledVec.z};</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> normSubVec = computeVecNorm(subVec);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="structMatrix.html">Matrix</a> F, invF,temp1;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,0&gt;( originalVec.x);  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,1&gt;( subVec.x/normSubVec); F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;0,2&gt;(-crossVec.x);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,0&gt;( originalVec.y);  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,1&gt;( subVec.y/normSubVec); F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;1,2&gt;(-crossVec.y);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,0&gt;( originalVec.z);  F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,1&gt;( subVec.z/normSubVec); F.<a class="code" href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">setValue</a>&lt;2,2&gt;(-crossVec.z);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  computeInverseMatrix(F,invF);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  performMatrixMultiplication&lt;false,false&gt;(G,invF,temp1);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  performMatrixMultiplication&lt;false,false&gt;(F,temp1,<a class="code" href="classRotationMatrix.html">RotationMatrix</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;__host__ <span class="keyword">static</span> <span class="keywordtype">void</span> <span class="keyword">inline</span> performRodriguesRotation(<a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a>  &amp; rotatedVec, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; inVec,<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; axis, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; angle){</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> cosAlpha = cos(angle);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> sinAlpha = sin(angle);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; crossProduct = computeCrossProduct(axis,inVec);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; dotProduct = computeDotProduct(axis,inVec);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> term1{cosAlpha*inVec.x,cosAlpha*inVec.y,cosAlpha*inVec.z};</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> term2{sinAlpha*crossProduct.x,sinAlpha*crossProduct.y,sinAlpha*crossProduct.z};</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> term3{axis.x,axis.y,axis.z};</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  scaleVec(term3,term3,(1-cosAlpha)*dotProduct);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  rotatedVec.x = term1.x + term2.x + term3.x;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  rotatedVec.y = term1.y + term2.y + term3.y;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  rotatedVec.z = term1.z + term2.z + term3.z;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> transpose&gt;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;__host__ __device__ <span class="keyword">static</span> <span class="keywordtype">void</span> doMatVec(<span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp; matrix, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vec, <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; matVec){</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span>(transpose) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    matVec.x = matrix.template getValue&lt;0,0&gt;() * vec.x + matrix.template getValue&lt;1,0&gt;() * vec.y + matrix.template getValue&lt;2,0&gt;() * vec.z;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    matVec.y = matrix.template getValue&lt;0,1&gt;() * vec.x + matrix.template getValue&lt;1,1&gt;() * vec.y + matrix.template getValue&lt;2,1&gt;() * vec.z;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    matVec.z = matrix.template getValue&lt;0,2&gt;() * vec.x + matrix.template getValue&lt;1,2&gt;() * vec.y + matrix.template getValue&lt;2,2&gt;() * vec.z;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    matVec.x = matrix.template getValue&lt;0,0&gt;() * vec.x + matrix.template getValue&lt;0,1&gt;() * vec.y + matrix.template getValue&lt;0,2&gt;() * vec.z;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    matVec.y = matrix.template getValue&lt;1,0&gt;() * vec.x + matrix.template getValue&lt;1,1&gt;() * vec.y + matrix.template getValue&lt;1,2&gt;() * vec.z;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    matVec.z = matrix.template getValue&lt;2,0&gt;() * vec.x + matrix.template getValue&lt;2,1&gt;() * vec.y + matrix.template getValue&lt;2,2&gt;() * vec.z;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> transpose&gt;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;__host__ __device__ <span class="keyword">static</span> <span class="keywordtype">void</span> rotate(<span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrix,  <a class="code" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> &amp; vecX, <a class="code" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> &amp; vecY, <a class="code" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> &amp; vecZ){</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> tempX, tempY, tempZ;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span>(transpose) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    tempX.x = rotationMatrix.template getValue&lt;0,0&gt;() * vecX.x + rotationMatrix.template getValue&lt;1,0&gt;() * vecY.x + rotationMatrix.template getValue&lt;2,0&gt;() * vecZ.x;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    tempY.x = rotationMatrix.template getValue&lt;0,1&gt;() * vecX.x + rotationMatrix.template getValue&lt;1,1&gt;() * vecY.x + rotationMatrix.template getValue&lt;2,1&gt;() * vecZ.x;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    tempZ.x = rotationMatrix.template getValue&lt;0,2&gt;() * vecX.x + rotationMatrix.template getValue&lt;1,2&gt;() * vecY.x + rotationMatrix.template getValue&lt;2,2&gt;() * vecZ.x;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    tempX.y = rotationMatrix.template getValue&lt;0,0&gt;() * vecX.y + rotationMatrix.template getValue&lt;1,0&gt;() * vecY.y + rotationMatrix.template getValue&lt;2,0&gt;() * vecZ.y;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    tempY.y = rotationMatrix.template getValue&lt;0,1&gt;() * vecX.y + rotationMatrix.template getValue&lt;1,1&gt;() * vecY.y + rotationMatrix.template getValue&lt;2,1&gt;() * vecZ.y;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    tempZ.y = rotationMatrix.template getValue&lt;0,2&gt;() * vecX.y + rotationMatrix.template getValue&lt;1,2&gt;() * vecY.y + rotationMatrix.template getValue&lt;2,2&gt;() * vecZ.y;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    tempX.x = rotationMatrix.template getValue&lt;0,0&gt;() * vecX.x + rotationMatrix.template getValue&lt;0,1&gt;() * vecY.x + rotationMatrix.template getValue&lt;0,2&gt;() * vecZ.x;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    tempY.x = rotationMatrix.template getValue&lt;1,0&gt;() * vecX.x + rotationMatrix.template getValue&lt;1,1&gt;() * vecY.x + rotationMatrix.template getValue&lt;1,2&gt;() * vecZ.x;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    tempZ.x = rotationMatrix.template getValue&lt;2,0&gt;() * vecX.x + rotationMatrix.template getValue&lt;2,1&gt;() * vecY.x + rotationMatrix.template getValue&lt;2,2&gt;() * vecZ.x;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    tempX.y = rotationMatrix.template getValue&lt;0,0&gt;() * vecX.y + rotationMatrix.template getValue&lt;0,1&gt;() * vecY.y + rotationMatrix.template getValue&lt;0,2&gt;() * vecZ.y;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    tempY.y = rotationMatrix.template getValue&lt;1,0&gt;() * vecX.y + rotationMatrix.template getValue&lt;1,1&gt;() * vecY.y + rotationMatrix.template getValue&lt;1,2&gt;() * vecZ.y;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    tempZ.y = rotationMatrix.template getValue&lt;2,0&gt;() * vecX.y + rotationMatrix.template getValue&lt;2,1&gt;() * vecY.y + rotationMatrix.template getValue&lt;2,2&gt;() * vecZ.y;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  vecX = tempX;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  vecY = tempY;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  vecZ = tempZ;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;__host__ <span class="keywordtype">bool</span> <span class="keyword">static</span> computeRotationMatrixK(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; k, <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrixK){</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> origK{0,0,1};</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  computeRotationMatrix(origK,k,rotationMatrixK);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#if DEBUG</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> shiftedK;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    doMatVec&lt;false&gt;(rotationMatrixK, origK, shiftedK);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    assert((<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(shiftedK.x, k.x)) and (<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(shiftedK.y, k.y)) and (<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(shiftedK.z, k.z)));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;__host__ <span class="keywordtype">bool</span> <span class="keyword">static</span> computeRotationMatrixBaseConfiguration(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; k, <span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrixK, <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrix, <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; rotAngle){</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> X{1,0,0};</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> numInterval = 100000;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> dTheta = M_PI/(numInterval*1.0);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> shiftedX;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  doMatVec&lt;false&gt;(rotationMatrixK,X,shiftedX);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> rotatedX;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> maxDiff = std::numeric_limits&lt;Real&gt;::infinity();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  rotAngle = 0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> i = 0; i &lt; numInterval; i++){</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    performRodriguesRotation(rotatedX,shiftedX,k,i*dTheta);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> diff = fabs(rotatedX.y);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span>(maxDiff &gt; diff){</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      maxDiff = diff;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      rotAngle = i*dTheta;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  assert(fabs(maxDiff) &lt; 1E-4);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  performRodriguesRotation(rotatedX,shiftedX,k,rotAngle);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  rotAngle = rotatedX.x &gt; 0 ? (rotAngle): (rotAngle)+M_PI;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  performRodriguesRotation(rotatedX,shiftedX,k,rotAngle);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">#if DEBUG</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> Y{0,1,0};</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> Z{0,0,1};</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> shiftedY,shiftedZ;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    doMatVec&lt;false&gt;(rotationMatrixK, Y, shiftedY);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    doMatVec&lt;false&gt;(rotationMatrixK, Z, shiftedZ);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> rotatedY, rotatedZ;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    performRodriguesRotation(rotatedY,shiftedY,k,rotAngle);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    performRodriguesRotation(rotatedZ,shiftedZ,k,rotAngle);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    assert(<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(computeDotProduct(shiftedX,shiftedY),0));</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    assert(<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(computeDotProduct(shiftedX,shiftedZ),0));</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    assert(<a class="code" href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a>(computeDotProduct(shiftedY,shiftedZ),0));</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  };</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="structMatrix.html">Matrix</a> rotationMatrixX;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  computeRotationMatrix(shiftedX,rotatedX,rotationMatrixX);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  performMatrixMultiplication&lt;false,false&gt;(rotationMatrixX,rotationMatrixK,rotationMatrix);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;__host__ <span class="keywordtype">bool</span> <span class="keyword">static</span> computeRotationMatrix(<span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; k, <span class="keyword">const</span> <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrixK, <a class="code" href="structMatrix.html">Matrix</a> &amp; rotationMatrix, <span class="keyword">const</span> <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp; rotAngle){</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> X{1,0,0};</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> shiftedX;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  doMatVec&lt;false&gt;(rotationMatrixK,X,shiftedX);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> rotatedX;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <a class="code" href="structMatrix.html">Matrix</a> rotationMatrixX;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  performRodriguesRotation(rotatedX,shiftedX,k,rotAngle);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  computeRotationMatrix(shiftedX,rotatedX,rotationMatrixX);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  performMatrixMultiplication&lt;false,false&gt;(rotationMatrixX,rotationMatrixK,rotationMatrix);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;__host__ <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> normalizeVec(<a class="code" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp; vec){</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> normVec =  computeVecNorm(vec);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  scaleVec(vec,vec,1./normVec);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;__host__ <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <span class="keyword">inline</span> computeWarpAffineMatrix(<span class="keyword">const</span> <span class="keywordtype">double</span>  srcPoint[][2], <span class="keyword">const</span> <span class="keywordtype">double</span>  dstPoint[][2], <span class="keywordtype">double</span>  warpAffineMatrix[][3]){</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; x0 = srcPoint[0][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; y0 = srcPoint[0][1];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; x1 = srcPoint[1][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; y1 = srcPoint[1][1];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; x2 = srcPoint[2][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; y2 = srcPoint[2][1];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; u0 = dstPoint[0][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; v0 = dstPoint[0][1];</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; u1 = dstPoint[1][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; v1 = dstPoint[1][1];</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; u2 = dstPoint[2][0]; <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; v2 = dstPoint[2][1];</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">double</span> denom = x0*y1-x1*y0-x0*y2+x2*y0+x1*y2-x2*y1;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  warpAffineMatrix[0][0] = (u0*y1-u1*y0-u0*y2+u2*y0+u1*y2-u2*y1)/(denom);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  warpAffineMatrix[0][1] = -(u0*x1-u1*x0-u0*x2+u2*x0+u1*x2-u2*x1)/(denom);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  warpAffineMatrix[0][2] = (u0*x1*y2-u0*x2*y1-u1*x0*y2+u1*x2*y0+u2*x0*y1-u2*x1*y0)/(denom);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  warpAffineMatrix[1][0] = (v0*y1-v1*y0-v0*y2+v2*y0+v1*y2-v2*y1)/(denom);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  warpAffineMatrix[1][1] = -(v0*x1-v1*x0-v0*x2+v2*x0+v1*x2-v2*x1)/(denom);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  warpAffineMatrix[1][2] = (v0*x1*y2-v0*x2*y1-v1*x0*y2+v1*x2*y0+v2*x0*y1-v2*x1*y0)/(denom);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#endif </span><span class="comment">//CY_RSOXS_ROTATION_H</span></div>
<div class="ttc" id="aDatatypes_8h_html"><div class="ttname"><a href="Datatypes_8h.html">Datatypes.h</a></div></div>
<div class="ttc" id="aDatatypes_8h_html_a2e2c38961834f28c06e17e074eb00bc7"><div class="ttname"><a href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a></div><div class="ttdeci">uint32_t UINT</div><div class="ttdef"><b>Definition:</b> Datatypes.h:52</div></div>
<div class="ttc" id="aDatatypes_8h_html_a40f8f353618437094a9e6c14c1d88a13"><div class="ttname"><a href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a></div><div class="ttdeci">float2 Complex</div><div class="ttdef"><b>Definition:</b> Datatypes.h:44</div></div>
<div class="ttc" id="aDatatypes_8h_html_a84d6f366d971f999fb49f140b4cda966"><div class="ttname"><a href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a></div><div class="ttdeci">float3 Real3</div><div class="ttdef"><b>Definition:</b> Datatypes.h:42</div></div>
<div class="ttc" id="aDatatypes_8h_html_aa5e6167c514e296d14c21b169cc7597e"><div class="ttname"><a href="Datatypes_8h.html#aa5e6167c514e296d14c21b169cc7597e">FEQUALS</a></div><div class="ttdeci">#define FEQUALS(x, y)</div><div class="ttdoc">Comparison for floating operation.</div><div class="ttdef"><b>Definition:</b> Datatypes.h:145</div></div>
<div class="ttc" id="aDatatypes_8h_html_ab685845059e8a2c92743427d9a698c70"><div class="ttname"><a href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a></div><div class="ttdeci">float Real</div><div class="ttdef"><b>Definition:</b> Datatypes.h:40</div></div>
<div class="ttc" id="aclassRotationMatrix_html"><div class="ttname"><a href="classRotationMatrix.html">RotationMatrix</a></div><div class="ttdoc">Class to compute the rotation matrix for all k Vector.</div><div class="ttdef"><b>Definition:</b> RotationMatrix.h:44</div></div>
<div class="ttc" id="acudaHeaders_8h_html"><div class="ttname"><a href="cudaHeaders_8h.html">cudaHeaders.h</a></div></div>
<div class="ttc" id="acudaHeaders_8h_html_a2eb6f9e0395b47b8d5e3eeae4fe0c116"><div class="ttname"><a href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a></div><div class="ttdeci">#define INLINE</div><div class="ttdef"><b>Definition:</b> cudaHeaders.h:37</div></div>
<div class="ttc" id="astructMatrix_html"><div class="ttname"><a href="structMatrix.html">Matrix</a></div><div class="ttdoc">Class to store 3D matrix.</div><div class="ttdef"><b>Definition:</b> Rotation.h:33</div></div>
<div class="ttc" id="astructMatrix_html_a03c741bad8657073a58bf7dc7fdfa01d"><div class="ttname"><a href="structMatrix.html#a03c741bad8657073a58bf7dc7fdfa01d">Matrix::Matrix</a></div><div class="ttdeci">__host__ Matrix(const Real *A)</div><div class="ttdoc">Copies the data from array.</div><div class="ttdef"><b>Definition:</b> Rotation.h:48</div></div>
<div class="ttc" id="astructMatrix_html_a3228dd32ec25ff16773ed41241d9c55f"><div class="ttname"><a href="structMatrix.html#a3228dd32ec25ff16773ed41241d9c55f">Matrix::getValue</a></div><div class="ttdeci">__host__ __device__ INLINE Real getValue() const</div><div class="ttdoc">returns the value at mat[id1,id2]</div><div class="ttdef"><b>Definition:</b> Rotation.h:58</div></div>
<div class="ttc" id="astructMatrix_html_a385c6db6cce3eac9018d3e8e03f394b7"><div class="ttname"><a href="structMatrix.html#a385c6db6cce3eac9018d3e8e03f394b7">Matrix::performMatrixMultiplication</a></div><div class="ttdeci">__host__ __device__ INLINE void performMatrixMultiplication(const Matrix &amp;A, const Matrix &amp;B)</div><div class="ttdoc">performs matrix multiplication</div><div class="ttdef"><b>Definition:</b> Rotation.h:109</div></div>
<div class="ttc" id="astructMatrix_html_a52c662f7ee48b0491cf1c3bb895f159d"><div class="ttname"><a href="structMatrix.html#a52c662f7ee48b0491cf1c3bb895f159d">Matrix::Matrix</a></div><div class="ttdeci">__host__ __device__ Matrix()</div><div class="ttdoc">Default Constructor.</div><div class="ttdef"><b>Definition:</b> Rotation.h:41</div></div>
<div class="ttc" id="astructMatrix_html_aa0d24add176004ed05a83dce58b983e1"><div class="ttname"><a href="structMatrix.html#aa0d24add176004ed05a83dce58b983e1">Matrix::printToFile</a></div><div class="ttdeci">__host__ void printToFile(std::ofstream &amp;fout) const</div><div class="ttdef"><b>Definition:</b> Rotation.h:158</div></div>
<div class="ttc" id="astructMatrix_html_aa0f15befa8c221eb7ced641ece7a1b53"><div class="ttname"><a href="structMatrix.html#aa0f15befa8c221eb7ced641ece7a1b53">Matrix::getValue</a></div><div class="ttdeci">__host__ INLINE void getValue(Real *mat) const</div><div class="ttdoc">Getter.</div><div class="ttdef"><b>Definition:</b> Rotation.h:68</div></div>
<div class="ttc" id="astructMatrix_html_aae7ff8e192d45879b7e252a99aaf673e"><div class="ttname"><a href="structMatrix.html#aae7ff8e192d45879b7e252a99aaf673e">Matrix::reset</a></div><div class="ttdeci">__host__ __device__ INLINE void reset()</div><div class="ttdoc">resets all entries to 0</div><div class="ttdef"><b>Definition:</b> Rotation.h:97</div></div>
<div class="ttc" id="astructMatrix_html_ab2be564f621160c535ae3ccd6fef7abd"><div class="ttname"><a href="structMatrix.html#ab2be564f621160c535ae3ccd6fef7abd">Matrix::matrix</a></div><div class="ttdeci">Real matrix[9]</div><div class="ttdoc">matrix object</div><div class="ttdef"><b>Definition:</b> Rotation.h:36</div></div>
<div class="ttc" id="astructMatrix_html_ac077e53d097d15478df9baa786fc0856"><div class="ttname"><a href="structMatrix.html#ac077e53d097d15478df9baa786fc0856">Matrix::print</a></div><div class="ttdeci">__host__ void print() const</div><div class="ttdef"><b>Definition:</b> Rotation.h:150</div></div>
<div class="ttc" id="astructMatrix_html_ac25f254ccf0e9c3dd291eb312a0ac5d7"><div class="ttname"><a href="structMatrix.html#ac25f254ccf0e9c3dd291eb312a0ac5d7">Matrix::setIdentity</a></div><div class="ttdeci">__host__ __device__ INLINE void setIdentity()</div><div class="ttdoc">sets matrix to identity matrix</div><div class="ttdef"><b>Definition:</b> Rotation.h:88</div></div>
<div class="ttc" id="astructMatrix_html_ac78eedef497f9e3b9bcb1c3ad8423331"><div class="ttname"><a href="structMatrix.html#ac78eedef497f9e3b9bcb1c3ad8423331">Matrix::setValue</a></div><div class="ttdeci">__host__ __device__ INLINE void setValue(const Real &amp;value)</div><div class="ttdoc">sets the value at mat[id1,id2]</div><div class="ttdef"><b>Definition:</b> Rotation.h:79</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
