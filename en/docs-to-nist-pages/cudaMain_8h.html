<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CyRSoXS: /github/workspace/include/cudaMain.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CyRSoXS
   &#160;<span id="projectnumber">1.1.6.0</span>
   </div>
   <div id="projectbrief">GPU Accelerated RSoXS Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cudaMain.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="cudaHeaders_8h_source.html">cudaHeaders.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Datatypes_8h_source.html">Datatypes.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Input_8h_source.html">Input/Input.h</a>&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;<a class="el" href="InputData_8h_source.html">Input/InputData.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Rotation_8h_source.html">Rotation.h</a>&gt;</code><br />
<code>#include &lt;cufft.h&gt;</code><br />
<code>#include &lt;<a class="el" href="RotationMatrix_8h_source.html">RotationMatrix.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cudaMain.h:</div>
<div class="dyncontent">
<div class="center"><img src="cudaMain_8h__incl.png" border="0" usemap="#a_2github_2workspace_2include_2cudaMain_8h" alt=""/></div>
<map name="a_2github_2workspace_2include_2cudaMain_8h" id="a_2github_2workspace_2include_2cudaMain_8h">
<area shape="rect" title=" " alt="" coords="1066,5,1239,47"/>
<area shape="rect" href="cudaHeaders_8h.html" title=" " alt="" coords="423,319,533,345"/>
<area shape="rect" title=" " alt="" coords="1167,393,1239,420"/>
<area shape="rect" href="Datatypes_8h.html" title=" " alt="" coords="839,319,930,345"/>
<area shape="rect" href="Input_8h.html" title=" " alt="" coords="1168,244,1263,271"/>
<area shape="rect" title=" " alt="" coords="1341,319,1401,345"/>
<area shape="rect" title=" " alt="" coords="1287,244,1346,271"/>
<area shape="rect" href="InputData_8h.html" title=" " alt="" coords="924,169,1045,196"/>
<area shape="rect" href="Rotation_8h.html" title=" " alt="" coords="566,244,646,271"/>
<area shape="rect" title=" " alt="" coords="1477,95,1535,121"/>
<area shape="rect" href="RotationMatrix_8h.html" title=" " alt="" coords="927,95,1042,121"/>
<area shape="rect" title=" " alt="" coords="268,393,403,420"/>
<area shape="rect" title=" " alt="" coords="427,393,529,420"/>
<area shape="rect" title=" " alt="" coords="554,393,741,420"/>
<area shape="rect" title=" " alt="" coords="765,393,823,420"/>
<area shape="rect" title=" " alt="" coords="5,393,65,420"/>
<area shape="rect" title=" " alt="" coords="89,393,157,420"/>
<area shape="rect" title=" " alt="" coords="181,393,244,420"/>
<area shape="rect" title=" " alt="" coords="847,393,922,420"/>
<area shape="rect" title=" " alt="" coords="946,393,1053,420"/>
<area shape="rect" title=" " alt="" coords="1077,393,1143,420"/>
<area shape="rect" title=" " alt="" coords="1253,319,1317,345"/>
<area shape="rect" title=" " alt="" coords="1167,319,1229,345"/>
<area shape="rect" title=" " alt="" coords="671,244,725,271"/>
<area shape="rect" title=" " alt="" coords="749,244,844,271"/>
<area shape="rect" title=" " alt="" coords="869,244,919,271"/>
<area shape="rect" title=" " alt="" coords="943,244,1002,271"/>
<area shape="rect" title=" " alt="" coords="1026,244,1093,271"/>
<area shape="rect" title=" " alt="" coords="579,319,633,345"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="cudaMain_8h__dep__incl.png" border="0" usemap="#a_2github_2workspace_2include_2cudaMain_8hdep" alt=""/></div>
<map name="a_2github_2workspace_2include_2cudaMain_8hdep" id="a_2github_2workspace_2include_2cudaMain_8hdep">
<area shape="rect" title=" " alt="" coords="81,5,254,47"/>
<area shape="rect" href="main_8cpp.html" title=" " alt="" coords="5,95,156,136"/>
<area shape="rect" href="pymain_8cpp.html" title=" " alt="" coords="180,95,331,136"/>
</map>
</div>
</div>
<p><a href="cudaMain_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe20faf35295196ec00120f931b52369"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#abe20faf35295196ec00120f931b52369">cudaMain</a> (const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *voxel, const <a class="el" href="classInputData.html">InputData</a> &amp;idata, const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;materialInput, <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *projectionAverage, <a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;rotationMatrix, const <a class="el" href="structVoxel.html">Voxel</a> *voxelInput)</td></tr>
<tr class="memdesc:abe20faf35295196ec00120f931b52369"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls for the cuda kernel are made through this function for Algorithm 1. Do not uses streams  <a href="cudaMain_8h.html#abe20faf35295196ec00120f931b52369">More...</a><br /></td></tr>
<tr class="separator:abe20faf35295196ec00120f931b52369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec50f373c9779b7929068e6bae4a4e69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#aec50f373c9779b7929068e6bae4a4e69">cudaMainStreams</a> (const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *voxel, const <a class="el" href="classInputData.html">InputData</a> &amp;idata, const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;materialInput, <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *projectionAverage, <a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;rotationMatrix, const <a class="el" href="structVoxel.html">Voxel</a> *voxelInput)</td></tr>
<tr class="memdesc:aec50f373c9779b7929068e6bae4a4e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls for the cuda kernel are made through this function for Algorithm 2. It uses streams  <a href="cudaMain_8h.html#aec50f373c9779b7929068e6bae4a4e69">More...</a><br /></td></tr>
<tr class="separator:aec50f373c9779b7929068e6bae4a4e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ef0d6d4814cb13b774fd1700834768b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a5ef0d6d4814cb13b774fd1700834768b">computePolarization</a> (const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *voxel, const <a class="el" href="classInputData.html">InputData</a> &amp;idata, const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;materialInput, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationX, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationY, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationZ, <a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;rotationMatrix, const <a class="el" href="structVoxel.html">Voxel</a> *voxelInput, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> EAngle, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> EnergyID, const int NUM_MATERIAL)</td></tr>
<tr class="memdesc:a5ef0d6d4814cb13b774fd1700834768b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls to compute polarization only. Only called with Pybind interface. Used in debugging  <a href="cudaMain_8h.html#a5ef0d6d4814cb13b774fd1700834768b">More...</a><br /></td></tr>
<tr class="separator:a5ef0d6d4814cb13b774fd1700834768b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc3b0a1b554deb4bc11b40cab3bbb6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#aacc3b0a1b554deb4bc11b40cab3bbb6a">warmup</a> ()</td></tr>
<tr class="separator:aacc3b0a1b554deb4bc11b40cab3bbb6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6b2eababffa71aea92c953ccda763e"><td class="memTemplParams" colspan="2">template&lt;ReferenceFrame referenceFrame&gt; </td></tr>
<tr class="memitem:abc6b2eababffa71aea92c953ccda763e"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#abc6b2eababffa71aea92c953ccda763e">computePolarization</a> (const <a class="el" href="structMaterial.html">Material</a> *d_materialConstants, const <a class="el" href="structVoxel.html">Voxel</a> *voxelInput, const uint3 voxel, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationX, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationY, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarizationZ, <a class="el" href="namespaceFFT.html#a3f0e38c37c7a89b5985bb8c99ee90ad2">FFT::FFTWindowing</a> windowing, const bool enable2D, const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a> morphologyType, const <a class="el" href="structMatrix.html">Matrix</a> rotationMatrix, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> numVoxels, const int DEVICE_NUM_MATERIAL)</td></tr>
<tr class="memdesc:abc6b2eababffa71aea92c953ccda763e"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPU kernel called from CPU for computing the polarization.  <a href="cudaMain_8h.html#abc6b2eababffa71aea92c953ccda763e">More...</a><br /></td></tr>
<tr class="separator:abc6b2eababffa71aea92c953ccda763e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63424e54852e0c85accd0d018f98a6ba"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a63424e54852e0c85accd0d018f98a6ba">computePolarization</a> (const <a class="el" href="structMaterial.html">Material</a> *d_materialConstants, const <a class="el" href="structVoxel.html">Voxel</a> *d_voxelInput, const uint3 &amp;voxel, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationX, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationY, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationZ, const <a class="el" href="namespaceFFT.html#a3f0e38c37c7a89b5985bb8c99ee90ad2">FFT::FFTWindowing</a> &amp;windowing, const bool &amp;enable2D, const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a> &amp;morphologyType, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a33c28531a671cc378e2ab03eecd3fe38">ReferenceFrame</a> &amp;referenceFrame, const <a class="el" href="structMatrix.html">Matrix</a> &amp;rotationMatrix, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;numVoxel, const int NUM_MATERIAL)</td></tr>
<tr class="memdesc:a63424e54852e0c85accd0d018f98a6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU function to compute <a class="el" href="classPolarization.html" title="Polarization computation for debugging.">Polarization</a> for Algorithm 1.  <a href="cudaMain_8h.html#a63424e54852e0c85accd0d018f98a6ba">More...</a><br /></td></tr>
<tr class="separator:a63424e54852e0c85accd0d018f98a6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae46df1eb54b8339c238ce64ed3b0af3b"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#ae46df1eb54b8339c238ce64ed3b0af3b">computePolarization</a> (const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_Nt, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_pX, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_pY, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_pZ, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a33c28531a671cc378e2ab03eecd3fe38">ReferenceFrame</a> &amp;referenceFrame, const <a class="el" href="structMatrix.html">Matrix</a> &amp;rotationMatrix, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;numVoxels)</td></tr>
<tr class="memdesc:ae46df1eb54b8339c238ce64ed3b0af3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPU kernel called from CPU for computing the polarization using Algorithm 2.  <a href="cudaMain_8h.html#ae46df1eb54b8339c238ce64ed3b0af3b">More...</a><br /></td></tr>
<tr class="separator:ae46df1eb54b8339c238ce64ed3b0af3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281926504f36eed77bb14c0d8230250e"><td class="memItemLeft" align="right" valign="top">__host__ <a class="el" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> cufftResult&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a281926504f36eed77bb14c0d8230250e">performFFT</a> (<a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarization, cufftHandle &amp;plan)</td></tr>
<tr class="memdesc:a281926504f36eed77bb14c0d8230250e"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> on GPU in place  <a href="cudaMain_8h.html#a281926504f36eed77bb14c0d8230250e">More...</a><br /></td></tr>
<tr class="separator:a281926504f36eed77bb14c0d8230250e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02bd3c56f0af0be574d528e0a101f717"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a02bd3c56f0af0be574d528e0a101f717">performFFTShift</a> (<a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *polarization, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const uint3 &amp;vx, const cudaStream_t stream)</td></tr>
<tr class="memdesc:a02bd3c56f0af0be574d528e0a101f717"><td class="mdescLeft">&#160;</td><td class="mdescRight">performs in place <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> Shift  <a href="cudaMain_8h.html#a02bd3c56f0af0be574d528e0a101f717">More...</a><br /></td></tr>
<tr class="separator:a02bd3c56f0af0be574d528e0a101f717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08afc6c6e42b9b8d40c727bf2108ff06"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a08afc6c6e42b9b8d40c727bf2108ff06">performScatter3DComputation</a> (const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationX, const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationY, const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationZ, <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *d_scatter3D, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;kMagnitude, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;voxelSize, const uint3 &amp;vx, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;physSize, const bool &amp;enable2D, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;kVector)</td></tr>
<tr class="separator:a08afc6c6e42b9b8d40c727bf2108ff06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419a58d999f90f93d413979a309df341"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a419a58d999f90f93d413979a309df341">peformEwaldProjectionGPU</a> (<a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *d_projection, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *d_scatter, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;kMagnitude, const uint3 &amp;vx, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;physSize, const <a class="el" href="namespaceInterpolation.html#a5d6ce66a7f0fee4df1914d03474da5a8">Interpolation::EwaldsInterpolation</a> &amp;interpolation, const bool &amp;enable2D, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;kVector)</td></tr>
<tr class="separator:a419a58d999f90f93d413979a309df341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf4b51f256a75b25be119d538cb185b"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#abbf4b51f256a75b25be119d538cb185b">peformEwaldProjectionGPU</a> (<a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *projection, const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationX, const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationY, const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_polarizationZ, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;kMagnitude, const uint3 &amp;vx, const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;physSize, const <a class="el" href="namespaceInterpolation.html#a5d6ce66a7f0fee4df1914d03474da5a8">Interpolation::EwaldsInterpolation</a> &amp;interpolation, const bool &amp;enable2D, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;kVector)</td></tr>
<tr class="separator:abbf4b51f256a75b25be119d538cb185b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983dbbce2d24c48608f093bd4ba3f233"><td class="memItemLeft" align="right" valign="top">__host__ int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cudaMain_8h.html#a983dbbce2d24c48608f093bd4ba3f233">computeNt</a> (const <a class="el" href="structMaterial.html">Material</a> *d_materialConstants, const <a class="el" href="structVoxel.html">Voxel</a> *d_voxelInput, <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *d_Nt, const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a> &amp;morphologyType, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;blockSize, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;numVoxels, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;offset, const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;endID, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;materialID, const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;numStreams, cudaStream_t stream, const int NUM_MATERIAL)</td></tr>
<tr class="memdesc:a983dbbce2d24c48608f093bd4ba3f233"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU function to compute Nt for Algorithm 2.  <a href="cudaMain_8h.html#a983dbbce2d24c48608f093bd4ba3f233">More...</a><br /></td></tr>
<tr class="separator:a983dbbce2d24c48608f093bd4ba3f233"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a983dbbce2d24c48608f093bd4ba3f233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983dbbce2d24c48608f093bd4ba3f233">&#9670;&nbsp;</a></span>computeNt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int computeNt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structMaterial.html">Material</a> *&#160;</td>
          <td class="paramname"><em>d_materialConstants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>d_voxelInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_Nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a> &amp;&#160;</td>
          <td class="paramname"><em>morphologyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>numVoxels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>endID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>materialID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>numStreams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cudaStream_t&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NUM_MATERIAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CPU function to compute Nt for Algorithm 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d_materialConstants</td><td>: <a class="el" href="structMaterial.html" title="Stores the material refractive index data.">Material</a> property. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d_voxelInput</td><td>: <a class="el" href="structVoxel.html">Voxel</a> property on GPU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_Nt</td><td>: computes Nt = (NR:NR - I) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">morphologyType</td><td>type of morphology Euler / Vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockSize</td><td>blocksize for GPU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numVoxels</td><td>Number of voxel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>offset in voxels according to streams </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">endID</td><td>finish ID for this particular stream </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">materialID</td><td>the material ID for the current loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numStreams</td><td>number of streams </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stream</td><td>stream context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NUM_MATERIAL</td><td>Number of material on Device. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EXIT_SUCEESS if completed </dd></dl>

</div>
</div>
<a id="ae46df1eb54b8339c238ce64ed3b0af3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae46df1eb54b8339c238ce64ed3b0af3b">&#9670;&nbsp;</a></span>computePolarization() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int computePolarization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_Nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_pX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_pY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_pZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a33c28531a671cc378e2ab03eecd3fe38">ReferenceFrame</a> &amp;&#160;</td>
          <td class="paramname"><em>referenceFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>numVoxels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPU kernel called from CPU for computing the polarization using Algorithm 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d_Nt</td><td>: Nt for a given energy. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_pX</td><td>polarization X vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_pY</td><td>polarization Y vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_pZ</td><td>polarization Z vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockSize</td><td>blocksize for GPU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">referenceFrame</td><td>reference frame where the P is calculated: LAB/MATERIAL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotationMatrix that rotates E field by a given angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numVoxels</td><td>Number of voxel. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a63424e54852e0c85accd0d018f98a6ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63424e54852e0c85accd0d018f98a6ba">&#9670;&nbsp;</a></span>computePolarization() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int computePolarization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structMaterial.html">Material</a> *&#160;</td>
          <td class="paramname"><em>d_materialConstants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>d_voxelInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3 &amp;&#160;</td>
          <td class="paramname"><em>voxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceFFT.html#a3f0e38c37c7a89b5985bb8c99ee90ad2">FFT::FFTWindowing</a> &amp;&#160;</td>
          <td class="paramname"><em>windowing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>enable2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a> &amp;&#160;</td>
          <td class="paramname"><em>morphologyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a33c28531a671cc378e2ab03eecd3fe38">ReferenceFrame</a> &amp;&#160;</td>
          <td class="paramname"><em>referenceFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>numVoxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NUM_MATERIAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CPU function to compute <a class="el" href="classPolarization.html" title="Polarization computation for debugging.">Polarization</a> for Algorithm 1. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d_materialConstants</td><td>: <a class="el" href="structMaterial.html" title="Stores the material refractive index data.">Material</a> property. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d_voxelInput</td><td>: <a class="el" href="structVoxel.html">Voxel</a> property on GPU. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxel</td><td>: dimension of morphology </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_polarizationX</td><td>device polarization X vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_polarizationY</td><td>device polarization Y vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d_polarizationZ</td><td>device polarization Z vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">windowing</td><td>The windowing type for <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enable2D</td><td>weather the morphology is 2D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">morphologyType</td><td>type of morphology Euler / Vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockSize</td><td>blocksize for GPU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">referenceFrame</td><td>reference frame where the P is calculated: LAB/MATERIAL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotationMatrix that rotates E field by a given angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numVoxel</td><td>Number of voxel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NUM_MATERIAL</td><td>Number of material on Device. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc6b2eababffa71aea92c953ccda763e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6b2eababffa71aea92c953ccda763e">&#9670;&nbsp;</a></span>computePolarization() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;ReferenceFrame referenceFrame&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__global__ void computePolarization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structMaterial.html">Material</a> *&#160;</td>
          <td class="paramname"><em>d_materialConstants</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>voxelInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3&#160;</td>
          <td class="paramname"><em>voxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceFFT.html#a3f0e38c37c7a89b5985bb8c99ee90ad2">FFT::FFTWindowing</a>&#160;</td>
          <td class="paramname"><em>windowing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a4647d611625bd69d178a75ba94490356">MorphologyType</a>&#160;</td>
          <td class="paramname"><em>morphologyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMatrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a>&#160;</td>
          <td class="paramname"><em>numVoxels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>DEVICE_NUM_MATERIAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPU kernel called from CPU for computing the polarization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d_materialConstants</td><td>: <a class="el" href="structMaterial.html" title="Stores the material refractive index data.">Material</a> optical constants for a given energy. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxelInput</td><td>: <a class="el" href="structVoxel.html">Voxel</a> property. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxel</td><td>: dimension of morphology </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationX</td><td>polarization X vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationY</td><td>polarization Y vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationZ</td><td>polarization Z vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">windowing</td><td>The windowing type for <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enable2D</td><td>weather the morphology is 2D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">morphologyType</td><td>type of morphology Euler / Vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotationMatrix that rotates E field by a given angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numVoxels</td><td>Number of voxel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DEVICE_NUM_MATERIAL</td><td>Number of material on Device. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5ef0d6d4814cb13b774fd1700834768b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ef0d6d4814cb13b774fd1700834768b">&#9670;&nbsp;</a></span>computePolarization() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int computePolarization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *&#160;</td>
          <td class="paramname"><em>voxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classInputData.html">InputData</a> &amp;&#160;</td>
          <td class="paramname"><em>idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>materialInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarizationZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>voxelInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a>&#160;</td>
          <td class="paramname"><em>EAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a>&#160;</td>
          <td class="paramname"><em>EnergyID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NUM_MATERIAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls to compute polarization only. Only called with Pybind interface. Used in debugging </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">voxel</td><td>array of size 3 which states the dimension along each axis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idata</td><td>inputData object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">materialInput</td><td>material Input containing the information of material property </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxelInput</td><td>voxel input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotation matrices for k / E vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationX</td><td>pX </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationY</td><td>pY </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">polarizationZ</td><td>pZ </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">EAngle</td><td>Angle of E rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NUM_MATERIAL</td><td>Number of material on Device. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="abe20faf35295196ec00120f931b52369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe20faf35295196ec00120f931b52369">&#9670;&nbsp;</a></span>cudaMain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cudaMain </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *&#160;</td>
          <td class="paramname"><em>voxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classInputData.html">InputData</a> &amp;&#160;</td>
          <td class="paramname"><em>idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>materialInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>projectionAverage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>voxelInput</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls for the cuda kernel are made through this function for Algorithm 1. Do not uses streams </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">voxel</td><td>array of size 3 which states the dimension along each axis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idata</td><td>inputData object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">materialInput</td><td>material Input containing the information of material property </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">projectionAverage</td><td>I(q) projected on Ewalds sphere </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxelInput</td><td>voxel input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotation matrices for k / E vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EXIT_SUCCESS on success of execution </dd></dl>

</div>
</div>
<a id="aec50f373c9779b7929068e6bae4a4e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec50f373c9779b7929068e6bae4a4e69">&#9670;&nbsp;</a></span>cudaMainStreams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cudaMainStreams </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> *&#160;</td>
          <td class="paramname"><em>voxel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classInputData.html">InputData</a> &amp;&#160;</td>
          <td class="paramname"><em>idata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structMaterial.html">Material</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>materialInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>projectionAverage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationMatrix.html">RotationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rotationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structVoxel.html">Voxel</a> *&#160;</td>
          <td class="paramname"><em>voxelInput</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls for the cuda kernel are made through this function for Algorithm 2. It uses streams </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">voxel</td><td>array of size 3 which states the dimension along each axis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idata</td><td>inputData object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">materialInput</td><td>material Input containing the information of material property </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">projectionAverage</td><td>I(q) projected on Ewalds sphere </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">voxelInput</td><td>voxel input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotationMatrix</td><td>rotation matrices for k / E vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EXIT_SUCCESS on success of execution </dd></dl>

</div>
</div>
<a id="a419a58d999f90f93d413979a309df341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419a58d999f90f93d413979a309df341">&#9670;&nbsp;</a></span>peformEwaldProjectionGPU() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int peformEwaldProjectionGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>d_projection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>d_scatter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>kMagnitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3 &amp;&#160;</td>
          <td class="paramname"><em>vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>physSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceInterpolation.html#a5d6ce66a7f0fee4df1914d03474da5a8">Interpolation::EwaldsInterpolation</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>enable2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;&#160;</td>
          <td class="paramname"><em>kVector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d_projection</td><td></td></tr>
    <tr><td class="paramname">d_scatter</td><td></td></tr>
    <tr><td class="paramname">kMagnitude</td><td></td></tr>
    <tr><td class="paramname">vx</td><td></td></tr>
    <tr><td class="paramname">physSize</td><td></td></tr>
    <tr><td class="paramname">interpolation</td><td></td></tr>
    <tr><td class="paramname">enable2D</td><td></td></tr>
    <tr><td class="paramname">blockSize</td><td></td></tr>
    <tr><td class="paramname">kVector</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="abbf4b51f256a75b25be119d538cb185b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf4b51f256a75b25be119d538cb185b">&#9670;&nbsp;</a></span>peformEwaldProjectionGPU() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int peformEwaldProjectionGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>projection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>kMagnitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3 &amp;&#160;</td>
          <td class="paramname"><em>vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>physSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceInterpolation.html#a5d6ce66a7f0fee4df1914d03474da5a8">Interpolation::EwaldsInterpolation</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>enable2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;&#160;</td>
          <td class="paramname"><em>kVector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">projection</td><td></td></tr>
    <tr><td class="paramname">d_polarizationX</td><td></td></tr>
    <tr><td class="paramname">d_polarizationY</td><td></td></tr>
    <tr><td class="paramname">d_polarizationZ</td><td></td></tr>
    <tr><td class="paramname">kMagnitude</td><td></td></tr>
    <tr><td class="paramname">vx</td><td></td></tr>
    <tr><td class="paramname">physSize</td><td></td></tr>
    <tr><td class="paramname">interpolation</td><td></td></tr>
    <tr><td class="paramname">enable2D</td><td></td></tr>
    <tr><td class="paramname">blockSize</td><td></td></tr>
    <tr><td class="paramname">kVector</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a281926504f36eed77bb14c0d8230250e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281926504f36eed77bb14c0d8230250e">&#9670;&nbsp;</a></span>performFFT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">__host__ <a class="el" href="cudaHeaders_8h.html#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> cufftResult performFFT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftHandle &amp;&#160;</td>
          <td class="paramname"><em>plan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>computes <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> on GPU in place </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">polarization</td><td>px/py/pz </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plan</td><td>The plan context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a02bd3c56f0af0be574d528e0a101f717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02bd3c56f0af0be574d528e0a101f717">&#9670;&nbsp;</a></span>performFFTShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int performFFTShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>polarization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3 &amp;&#160;</td>
          <td class="paramname"><em>vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cudaStream_t&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>performs in place <a class="el" href="namespaceFFT.html" title="Fast Fourier Transform.">FFT</a> Shift </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">polarization</td><td>px/py/pz </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">blockSize</td><td>blocksize of GPU kernel </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vx</td><td>voxel dims in all direction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">stream</td><td>cuda stream context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a08afc6c6e42b9b8d40c727bf2108ff06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08afc6c6e42b9b8d40c727bf2108ff06">&#9670;&nbsp;</a></span>performScatter3DComputation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__host__ int performScatter3DComputation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a40f8f353618437094a9e6c14c1d88a13">Complex</a> *&#160;</td>
          <td class="paramname"><em>d_polarizationZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> *&#160;</td>
          <td class="paramname"><em>d_scatter3D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>kMagnitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a95d34960b5edcc07159a469a3dd265b0">BigUINT</a> &amp;&#160;</td>
          <td class="paramname"><em>voxelSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint3 &amp;&#160;</td>
          <td class="paramname"><em>vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#ab685845059e8a2c92743427d9a698c70">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>physSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>enable2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a2e2c38961834f28c06e17e074eb00bc7">UINT</a> &amp;&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Datatypes_8h.html#a84d6f366d971f999fb49f140b4cda966">Real3</a> &amp;&#160;</td>
          <td class="paramname"><em>kVector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d_polarizationX</td><td>device polarization X vector </td></tr>
    <tr><td class="paramname">d_polarizationY</td><td>device polarization Y vector </td></tr>
    <tr><td class="paramname">d_polarizationZ</td><td>device polarization Z vector </td></tr>
    <tr><td class="paramname">d_scatter3D</td><td>scatter 3D computation </td></tr>
    <tr><td class="paramname">kMagnitude</td><td>k magnitude </td></tr>
    <tr><td class="paramname">voxelSize</td><td>voxel size </td></tr>
    <tr><td class="paramname">vx</td><td>voxel dimensions </td></tr>
    <tr><td class="paramname">physSize</td><td>physSize </td></tr>
    <tr><td class="paramname">enable2D</td><td>true for 2D morphology </td></tr>
    <tr><td class="paramname">blockSize</td><td>blockSize </td></tr>
    <tr><td class="paramname">kVector</td><td>kVector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="aacc3b0a1b554deb4bc11b40cab3bbb6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc3b0a1b554deb4bc11b40cab3bbb6a">&#9670;&nbsp;</a></span>warmup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int warmup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is done to warmup the GPU. The first instruction takes usulally a larger amount of time. This is done to remove the effect in computing total time. </p><dl class="section return"><dt>Returns</dt><dd>EXIT_SUCCESS on success of warmup or EXIT_FAILURE if warmp fails </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
